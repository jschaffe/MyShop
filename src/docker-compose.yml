version: '2'
networks:
  myshop:
    driver: overlay
services:
  proxy:
    image: jsdockerregistry.azurecr.io/shop/nginx-proxy:latest
    ports: ["80:80"]
    networks:
      - myshop
  products:
    image: jsdockerregistry.azurecr.io/shop/products-api:BuildNumber
    networks:
      - myshop
  ratings:
    image: jsdockerregistry.azurecr.io/shop/ratings-api:BuildNumber
    networks:
      - myshop
  recommandations:
    image: jsdockerregistry.azurecr.io/shop/recommendations-api:BuildNumber
    networks:
      - myshop
#  shop:
#    image: jsdockerregistry.azurecr.io/shop/front:BuildNumber
#    networks:
#      - myshop
#    environment:
#      - SHOP_PRODUCTS_API_URL=http://acsmyshop-agents.westeurope.cloudapp.azure.com/products/
#      - SHOP_RATINGS_API_URL=http://acsmyshop-agents.westeurope.cloudapp.azure.com/ratings/
#      - SHOP_RECOMMANDATIONS_API_URL=http://acsmyshop-agents.westeurope.cloudapp.azure.com/recommandations/